(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[707],{9002:function(e,t,a){"use strict";a.d(t,{Z:function(){return R}});var r=a(5893),s=a(1654),i=a(7294),l=a(4628),n=a(4193),c=a(9544),u=a(2062),o=a(50),d=a(3635),h=a(5287),m=e=>{let{tags:t,onToggle:a,name:l,type:n}=e,[c,u]=(0,i.useState)([]),[o,m]=(0,i.useState)(t),_=(e,t)=>{a(l,e,t)};return(0,i.useEffect)(()=>{let e=async()=>{let e=await (0,h.K)(n);u(e)};e()},[]),(0,i.useEffect)(()=>{m(t)},[t]),(0,r.jsxs)("div",{className:"h-fit",children:[(0,r.jsx)(s.Z,{variant:"h3",children:"With genres"}),(0,r.jsx)("div",{className:"flex flex-wrap justify-start items-start mb-5",children:c.map(e=>(0,r.jsx)(d.Z,{tag:e,isEdit:!0,isSelected:o&&o.some(t=>t.name===e.name),onToggle:_},e.name))})]})},_=a(5221),f=a(1590),y=a(406),g=a.n(y),p=a(2226);let x=g()(5),v=async e=>{let t=await fetch(p.wc),a=await t.json(),r=a.map(async t=>x(()=>fetch(p.bi.replace("{type}",e).replace("{country}",t.iso_3166_1.toLowerCase())).then(e=>e.json()))),s=await Promise.all(r),i=a.filter((e,t)=>s[t].results.length>0);return i};var w=e=>{let{formData:t,onRemove:a,onReset:i,countryList:l}=e;return 0===Object.keys(t).length?null:(0,r.jsxs)("div",{className:"mb-4 p-4 gap-4 bg-gray-900 rounded-md",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)(s.Z,{variant:"h3",className:"!mb-0 mr-2",children:"Selected filters"}),(0,r.jsx)(n.Z,{context:"text",onClick:i,children:"Reset"})]}),(0,r.jsx)("div",{className:"flex flex-wrap justify-start items-start",children:Object.keys(t).map((e,s)=>{var i,n;switch(e){case"primary_release_year":case"first_air_date_year":case"vote_average.lte":return(0,r.jsx)(d.Z,{tag:{name:null!==(i=t[e])&&void 0!==i?i:"",field:e},isEdit:!0,onRemove:a},e);case"with_people":case"with_companies":case"with_keywords":case"with_genres":return(null!==(n=t[e])&&void 0!==n?n:[]).map(e=>(0,r.jsx)(d.Z,{tag:{name:e.name,field:Object.keys(t)[s]},isEdit:!0,onRemove:a},e.name));case"with_original_language":let c=l.find(a=>a.iso_3166_1.toLowerCase()===t[e]),u=c.english_name;return(0,r.jsx)(d.Z,{tag:{name:u,field:e},isEdit:!0,onRemove:a},e)}})})]})};let j={primary_release_year:!0,first_air_date_year:!0,"vote_average.lte":!0,with_people:!0,with_companies:!0,with_genres:!1,with_original_language:!0,with_keywords:!0},E=Object.keys(j).filter(e=>j[e]).map(e=>e),b=Object.keys(j).filter(e=>!j[e]).map(e=>e),A={};var S=()=>(0,i.useReducer)((e,t)=>{switch(t.type){case"RESET":return A;case"SELECT_FIELD_CHANGE":return{...e,[t.field]:t.value};case"ARRAY_FIELD_CHANGE":return{...e,[t.field]:Array.isArray(e[t.field])?[...e[t.field],t.value]:[t.value]};case"REMOVE_TAG":let a=Array.isArray(e[t.tag.field])?e[t.tag.field].filter(e=>e.name!==t.tag.name):[],r={...e,[t.tag.field]:a};if(0===a.length){let{[t.tag.field]:e,...a}=r;return a}return r;case"TOGGLE_TAG":let s=Array.isArray(e[t.field])?e[t.field]:[],i=t.isChecked?s.filter(e=>e.name!==t.tag.name):[...s,t.tag],l={...e,[t.field]:i};if(0===i.length){let{[t.field]:e,...a}=l;return a}return l;default:return e}},A);let N=e=>{let t=[];for(let a in e)if(e.hasOwnProperty(a)){let r=e[a],s=Array.isArray(r)?r.map(e=>null==e?void 0:e.id).join(","):null==r?void 0:r.id,i=Array.isArray(r)?s:"".concat(r);t.push("".concat(a,"=").concat(i||""))}return"&".concat(t.join("&").replace(/\s/g,""))},Z=e=>{let t=new Date().getFullYear(),a=[];for(let r=e;r<=t;r++)a.push(r.toString());return a},C=e=>Array.from({length:e},(e,t)=>(t+1).toFixed(1)),k=e=>{switch(e){case"primary_release_year":case"first_air_date_year":return Z(1930);case"vote_average.lte":return C(10)}};var R=e=>{let{onApplyFilter:t,collectionType:a,fields:d,defaultUrl:h}=e,[y,g]=S(),[p,x]=(0,i.useState)(!1),[j,A]=(0,i.useState)(""),[Z,C]=(0,i.useState)([]),R=(e,t)=>{g({type:"SELECT_FIELD_CHANGE",field:e,value:t})},T=(e,t)=>{g({type:"ARRAY_FIELD_CHANGE",field:e,value:t})},L=(e,t,a)=>{g({type:"TOGGLE_TAG",field:e,tag:t,isChecked:a})},G=async e=>{e.preventDefault(),x(!0);try{let e=0===Object.keys(y).length?"":N(y);t(h.concat(e)),A("")}catch(e){A(e.toString())}finally{x(!1)}},O=e=>{var t,s,i,l;switch(e){case"primary_release_year":case"first_air_date_year":case"vote_average.lte":let n=k(e),c=null!==(t=y[e])&&void 0!==t?t:"Select";return(0,r.jsx)(o.Z,{label:f.BM[e],name:e,onChange:R,defaultValue:c,children:n.map((e,t)=>(0,r.jsx)(u.Z,{value:e,label:e},t))},e);case"with_original_language":let d=null!==(i=null===(s=Z.find(t=>t.iso_3166_1.toLowerCase()===y[e]))||void 0===s?void 0:s.english_name)&&void 0!==i?i:"Select";return(0,r.jsx)(o.Z,{label:f.BM[e],name:e,onChange:R,defaultValue:d,children:Z.map((e,t)=>(0,r.jsx)(u.Z,{value:e.iso_3166_1.toLowerCase(),label:e.english_name},t))},e);case"with_people":case"with_companies":case"with_keywords":return(0,r.jsx)(_.Z,{name:e,label:f.BM[e],urlToFetch:f.NH[e].toString(),onSearch:T},e);case"with_genres":return(0,r.jsx)(m,{tags:null!==(l=y[e])&&void 0!==l?l:[],onToggle:L,name:e,type:a},e)}},z=e=>e.map(e=>{if(d.includes(e))return O(e)});return(0,i.useEffect)(()=>{let e=async()=>{let e=await v(a);C(e)};e()},[]),(0,r.jsxs)("div",{className:"mb-16 bg-gray-950",children:[(0,r.jsx)(s.Z,{children:"Filter"}),(0,r.jsxs)("form",{onSubmit:G,children:[(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:z(E)}),(0,r.jsx)("div",{children:z(b)}),(0,r.jsx)(w,{formData:y,onRemove:e=>{g({type:"REMOVE_TAG",tag:e})},onReset:()=>{g({type:"RESET"}),t(h)},countryList:Z}),(0,r.jsx)(n.Z,{type:"submit",className:"mx-auto",children:p?(0,r.jsx)(l.Z,{isShowText:!0,type:"static"}):"Apply"}),j&&(0,r.jsx)(c.Z,{className:"px-4 py-2 bg-rose-600/20 w-full rounded-md",error:j})]})]})}},8960:function(e,t,a){"use strict";var r=a(5893),s=a(1654),i=a(9603),l=a(9417);t.Z=e=>{let{title:t,text:a}=e;return(0,r.jsxs)("div",{className:"w-full h-full flex flex-col justify-center items-center flex-1 text-center",children:[(0,r.jsx)(i.G,{icon:l.QLU,className:"text-rose-600 text-2xl mb-4"}),(0,r.jsx)(s.Z,{variant:"h3",children:t}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:a})]})}},7396:function(e,t,a){"use strict";var r=a(7294),s=a(2624),i=a(7245),l=a(5037);t.Z=(e,t)=>{let{showModal:a}=(0,i.d)(),[n,c]=(0,r.useState)(!0),[u,o]=(0,r.useState)(null);return(0,r.useEffect)(()=>{c(!0),e?o(e):(0,l.Z)(t,1).then(e=>{o(e)}).catch(()=>{(0,s.s9)(a,"An error has occurred")}).finally(()=>{c(!1)})},[e]),{items:u,isLoading:n}}},406:function(e,t,a){"use strict";let r=a(9778);e.exports=e=>{if(!((Number.isInteger(e)||e===1/0)&&e>0))throw TypeError("Expected `concurrency` to be a number from 1 and up");let t=new r,a=0,s=()=>{a--,t.size>0&&t.dequeue()()},i=async(e,t,...r)=>{a++;let i=(async()=>e(...r))();t(i);try{await i}catch{}s()},l=(r,s,...l)=>{t.enqueue(i.bind(null,r,s,...l)),(async()=>{await Promise.resolve(),a<e&&t.size>0&&t.dequeue()()})()},n=(e,...t)=>new Promise(a=>{l(e,a,...t)});return Object.defineProperties(n,{activeCount:{get:()=>a},pendingCount:{get:()=>t.size},clearQueue:{value:()=>{t.clear()}}}),n}},9778:function(e){class t{constructor(e){this.value=e,this.next=void 0}}class a{constructor(){this.clear()}enqueue(e){let a=new t(e);this._head?this._tail.next=a:this._head=a,this._tail=a,this._size++}dequeue(){let e=this._head;if(e)return this._head=this._head.next,this._size--,e.value}clear(){this._head=void 0,this._tail=void 0,this._size=0}get size(){return this._size}*[Symbol.iterator](){let e=this._head;for(;e;)yield e.value,e=e.next}}e.exports=a}}]);