(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[186],{9178:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/collection",function(){return r(418)}])},9377:function(e,t,r){"use strict";r.d(t,{Z:function(){return y}});var i=r(5893),l=r(1654),s=r(4033),o=r(4914),n=r(4193),c=r(8878),a=r(3851),u=e=>{let{items:t}=e,{itemsToShow:r,getItemsToShow:l,isShowMoreButton:s,buttonText:o,listRef:u}=(0,a.Z)(t,8,180);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{ref:u,className:"grid grid-cols-[repeat(auto-fill,141px)] gap-4 justify-center mb-8",children:r.map((e,t)=>(0,i.jsx)(c.Z,{itemId:e.markedItemId,mark:e.markValue,collectionType:e.collectionType,isLinkToMovie:!0},t))}),s&&(0,i.jsx)(n.Z,{className:"mx-auto mt-8",context:"empty",onClick:l,children:o})]})},d=r(1664),m=r.n(d),w=r(8642),v=r(1207),h=e=>{let{items:t,collectionType:r}=e,{userId:l}=(0,w.a)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"grid grid-cols-[repeat(auto-fill,232px)] gap-x-5 justify-center",children:t.map((e,t)=>{if(t<=4)return(0,i.jsx)(v.Z,{item:e,collectionType:r,isShowButton:!1},t)})}),(0,i.jsx)(m(),{href:"/collection/[type]?uid=".concat(l,"&type=").concat(r),as:"/collection/".concat(r,"?uid=").concat(l,"&type=").concat(r),className:"w-full md:w-72 border-2 border-rose-600 duration-300 font-semibold leading-none text-rose-600 rounded-3xl hover:border-transparent hover:w-full hover:text-rose-500 p-3 flex justify-center items-center mx-auto mt-8",children:"View ".concat(r," collection")})]})},f=r(1590),p=e=>{let{title:t,collectionType:r,items:n,isCurrentUserCollection:c,collectionOwnerId:a}=e,d=r!==f.zS.reviews;return n.length?(0,i.jsxs)("div",{className:"my-16 first:mt-0 last:mb-0",children:[d&&(0,i.jsx)(l.Z,{children:t}),(()=>{switch(r){case"reviews":return(0,i.jsx)(o.Z,{reviews:n,className:"!mb-0",collectionOwnerId:a,isCollectionList:!0});case"marks":return(0,i.jsx)(u,{items:n});case"movie":case"tv":case"person":return(0,i.jsx)(h,{items:n,collectionType:r})}})()]}):(0,i.jsx)(s.Z,{title:t,text:c?(()=>{switch(r){case"movie":case"person":return"Please add some ".concat(r," to your collection before you can see it here");case"tv":return"Please add some TV show to your collection before you can see it here";case"marks":return"Please rate something before you can see it here";case"reviews":return"Please write a review before you can see it here"}})():void 0,className:"border border-gray-500 mb-4 p-4 last:mb-0"})},y=e=>{let{movies:t,tvShows:r,persons:l,marks:s,reviews:o,isCurrentUserCollection:n=!0,collectionOwnerId:c}=e;return(0,i.jsxs)("div",{className:"mt-24 md:mt-0",children:[(0,i.jsx)(p,{title:"Movies",collectionType:f.zS.movie,items:null!=t?t:[],isCurrentUserCollection:n}),(0,i.jsx)(p,{title:"TV shows",collectionType:f.zS.tv,items:null!=r?r:[],isCurrentUserCollection:n}),(0,i.jsx)(p,{title:"Persons",collectionType:f.zS.person,items:null!=l?l:[],isCurrentUserCollection:n}),(0,i.jsx)(p,{title:"Marks",collectionType:f.zS.marks,items:null!=s?s:[],isCurrentUserCollection:n}),(0,i.jsx)(p,{title:"Reviews",collectionType:f.zS.reviews,items:null!=o?o:[],isCurrentUserCollection:n,collectionOwnerId:c})]})}},7221:function(e,t,r){"use strict";r.d(t,{n:function(){return u}});var i=r(9105),l=r(8218),s=r(9810),o=r(3863),n=r(1590);let c=async e=>{try{let t=async t=>{let r=[],s="users/".concat(e,"/collection/marks/").concat(t),o=(0,i.iH)(l.F,s),n=await (0,i.U2)(o);return n.exists()&&n.forEach(e=>{let t=e.val();r.push(t)}),r},r=await t(n.zS.movie),s=await t(n.zS.tv);return[...r,...s]}catch(e){throw e}},a=async(e,t)=>{let r=t.type;try{switch(r){case"movie":case"tv":case"person":let l=await Promise.all(e.map(async e=>{let r=await (0,s.R)(t.type,e,"");return r})),n=(0,o.v)(l);return n;case"reviews":case"replies":return await Promise.all(e.map(async e=>{let r=await (0,i.U2)((0,i.iU)(t.ref,e));return r.val()}));case"marks":return await c(t.userId)}}catch(e){throw e}},u=async function(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;try{let o;let n=(0,i.iH)(l.F,"users/".concat(e,"/")),c=await (0,i.U2)(n);if(!c.exists())throw"Failed to fetch";let u="users/".concat(e,"/collection/").concat(t,"/"),d=(0,i.iH)(l.F,u);o=s?null!==r?(0,i.IO)(d,(0,i.R)(),(0,i.TQ)(s),(0,i.Kk)(r+1)):(0,i.IO)(d,(0,i.R)(),(0,i.TQ)(s)):null!==r?(0,i.IO)(d,(0,i.R)(),(0,i.Kk)(r+1)):(0,i.IO)(d,(0,i.R)());let m=await (0,i.U2)(o),w=m.val()||{},v=Object.keys(w),h=!1;if(null!==r&&v.length>r&&(h=!0,v.pop()),!v.length)return{isMoreDataAvailable:h,items:[]};let f=await a(v,{type:t,ref:d,userId:e});return{isMoreDataAvailable:h,items:f}}catch(e){throw e}}},3196:function(e,t,r){"use strict";r.d(t,{J:function(){return d}});var i=r(8218),l=r(9810),s=r(1590),o=r(9105);let n=async(e,t,r)=>{let l="users/".concat(e,"/collection/reviews/").concat(r,"/").concat(t),s=(0,o.iH)(i.F,l);try{let e=await (0,o.U2)(s);if(!e.exists())return;{let t=e.val();return t}}catch(e){return null}},c=(e,t)=>new Promise(async r=>{let i=t.filter(e=>void 0!==e.reviewedItemId&&void 0!==e.reviewId),o=new Set,c=async(e,t,r)=>{let i=await (0,l.R)(r,e,"/reviews"),s=i.results.find(e=>e.id===t);if(!o.has(t)&&s){let i={...s,reviewedItemId:e,reviewedItemCollectionType:r};return o.add(t),i}return null},a=i.map(t=>{let r=!t.reviewAuthorId,i=t.reviewAuthorId===e,l=t.reviewedItemCollectionType===s.zS.movie;if(l&&!i)return r?c(t.reviewedItemId,t.reviewId,s.zS.movie):n(t.reviewAuthorId,t.reviewId,s.zS.movie)}),u=i.map(t=>{let r=!t.reviewAuthorId,i=t.reviewAuthorId===e,l=t.reviewedItemCollectionType===s.zS.tv;if(l&&!i)return r?c(t.reviewedItemId,t.reviewId,s.zS.tv):n(t.reviewAuthorId,t.reviewId,s.zS.tv)}),d=await Promise.all(a),m=await Promise.all(u),w=d.filter(e=>null!=e),v=m.filter(e=>null!=e);r([...w,...v].filter(e=>void 0!==e))});var a=r(7221);let u=async(e,t)=>{try{let r="users/".concat(e,"/collection/").concat(t,"/"),l=(0,o.iH)(i.F,r),s=(0,o.IO)(l,(0,o.R)()),n=await (0,o.U2)(s),c=n.val()||{},a=[];for(let e in c){let t=c[e];for(let e in t){let r=t[e];a.push(r)}}return a}catch(e){throw e}},d=async e=>{try{let t=await (0,a.n)(e,s.zS.movie,5),r=await (0,a.n)(e,s.zS.tv,5),i=await (0,a.n)(e,s.zS.person,5),l=await (0,a.n)(e,s.zS.marks,null),o=await u(e,s.zS.reviews),n=await u(e,s.zS.replies),d=await c(e,n),m=[...o.filter(e=>void 0!==e.reviewedItemId&&void 0!==e.id),...d];return{collectionMovies:t.items,collectionTVShows:r.items,collectionPersons:i.items,allCollectionReviews:m,collectionMarks:l.items}}catch(e){throw e}}},418:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSP:function(){return j},default:function(){return S}});var i=r(5893),l=r(7294),s=r(1654),o=r(4193),n=r(2624),c=r(7245),a=r(3155),u=r(9603),d=r(9417),m=r(8642),w=r(1163),v=r(1084),h=r(9377),f=r(6986),p=r(3196);let y=async(e,t,r)=>{let i=!t;if(i)return null;let l=!e;l&&r(f.A6.replace("{userId}",t));let s=t!==e;s&&r("/404");try{let t=await (0,p.J)(e);if(!t)return null;return{collectionMovies:t.collectionMovies,collectionTVShows:t.collectionTVShows,collectionPersons:t.collectionPersons,allCollectionReviews:t.allCollectionReviews,collectionMarks:t.collectionMarks}}catch(e){throw e}};var x=r(4628),I=r(8960),j=!0,S=e=>{let{generalCollectionPageProps:t}=e,[r,f]=(0,l.useState)(!0),[p,j]=(0,l.useState)(null),{showModal:S}=(0,c.d)(),g=(0,w.useRouter)(),{userId:k}=(0,m.a)();return((0,l.useEffect)(()=>{let e=async()=>{f(!0);let e=g.query.uid;y(e,k,e=>{g.push(e)}).then(e=>{j(e)}).catch(()=>{(0,n.s9)(S,"An error has occurred")}).finally(()=>{f(!1)})};k&&(t?j(t):e())},[t,g.query.uid]),k)?p?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.Z,{imageSrc:v.dK}),(0,i.jsx)(h.Z,{movies:p.collectionMovies,tvShows:p.collectionTVShows,persons:p.collectionPersons,marks:p.collectionMarks,reviews:p.allCollectionReviews})]}):r?(0,i.jsx)(x.Z,{className:"bg-transparent"}):(0,i.jsx)(I.Z,{title:"Something went wrong",text:"No data found"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.Z,{imageSrc:"/35z8hWuzfFUZQaYog8E9LsXW3iI.jpg"}),(0,i.jsxs)("div",{className:"max-w-4xl",children:[(0,i.jsxs)(s.Z,{className:"text-3xl md:text-7xl",children:["Your favorite movies, TV shows and persons will be displayed here",(0,i.jsx)(u.G,{icon:d.CjD,className:"ml-4 text-rose-600"})]}),(0,i.jsx)("p",{className:"mb-8",children:"Please login or register to be able to create your own collection"}),(0,i.jsx)(o.Z,{onClick:()=>(0,n.Mo)(S),children:"Sign In"})]})]})}}},function(e){e.O(0,[885,347,342,951,774,888,179],function(){return e(e.s=9178)}),_N_E=e.O()}]);